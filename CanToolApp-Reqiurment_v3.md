# CanToolAPP——需求分析文档 #
随着汽车技术的发展，CAN通讯技术的应用逐步趋于成熟。其中，汽车中会使用多个电子控制装置（ECU：Electronic Control Unit）对整车进行控制。然而，ECU之间的信息交换更多地依赖于CAN总线的网络连接方式来完成。为了检测和控制CAN bus的信息内容，需要使用CAN bus检测设备。CanTool装置是完成CANbus检测的工具。所以，本文提出的**CanToolApp**软件是用来实现CAN数据的显示及控制。

## 任务概要##
###目标###
本系统目的在于利用本文提出的**CanToolApp**软件来实现CAN数据的显示及控制，从而能够利用CAN信息进行通信，具体的总体框架图如图1所示。

![](https://i.imgur.com/2a9mJzH.png)


- 本文所述的软件需要将CanTool装置采集的CAN信息发送到上位机（移动终端Android、iOS、Windows PC），并由运行在上位机中的**CanToolApp**软件接收这些信息，显示在用户图形(GUI)界面上。
- 并且,在**CanToolApp**的界面上还可以设定CAN信息，通过GUI按钮将设定的CAN信息发送给CanTool装置，CanTool装置将按照规定的信息格式，将信息发送到CAN总线上。
- 此外，**CanToolApp**能够设定CAN总线的通信参数，并通过相应的命令设置CanTool装置的CAN通信参数，从而使CanTool装置能够与CAN总线上的其他被测ECU进行正常的通信。

###用户特点###
- 汽车技术人员：经常性用户，具备使用软件的能力。
- 维护人员：间隔性用户，专业技术人员，精通软件开发与CAN信息通信技术原理。


## 功能需求分析##
**CanToolApp**软件是用来实现CAN数据的显示及控制，主要用于解决检测和控制CAN bus的信息的问题。所以，主要需要考虑以及解决系统功能性需求为以下几个方面。图2和图2分别给出了整体软件系统的数据流图和用户用例图。
![](https://i.imgur.com/IJco68c.png)
![](https://i.imgur.com/Sc06LEq.png)


###COM口基本设定信息需求分析###
能够搜索到本机所有可使用的COM口，并让用户选择CanTool装置在上位机中映射的COM口。并需要设置相应COM口波特率115200、数据位数8、停止位数1。将设定内容可保存到设定文件中，以供下次使用。
###CAN基本设定信息需求分析###
能够实现CANtool装置的CAN速率设置、进入CAN工作状态（Open）、进入CAN初始化状态（ Close）。将这些设定内容保存到设定文件中，以供下次使用。
###CAN信息原始数据及物理数据实时显示需求分析###
能够对接收到的多个CAN信息，通过CAN信息及CAN信号数据库进行解析，然后将CAN信息原始数据进行显示。并能显示CAN信息中的CAN信号的物理值实时数据。
###CAN信号的物理值实时数据显示需求分析###
可以选择仪表盘方式显示接收到CAN信号物理值。将这些显示方式保存到设定文件中，供下次使用。
###CAN信号变化进行显示需求分析###
选择某些接收到的CAN信号，显示其变化的实时物理值曲线。
###CAN信息数据保存需求分析###
将接收到的所有CAN信息数据，进行实时保存。
###CAN信号的发送以及设定值需求分析###
指定要发送的多个CAN信息，并设定CAN信号的物理值以及发送周期。
###App将物理值发送到CAN总线过程需求分析###
App将设定的物理值转换为CAN信号值，将CAN信息中包含的所有CAN信号合成完整的CAN信息后，先发送给CanTool装置，再发送到CAN总线上。
###CAN信息和信号数据库加载需求分析###
加载用户提供的CAN信息和信号数据库，完成CAN信号数据的解析以及CAN发送信息的组装。并显示CAN信号在CAN信息上的布局，未加载数据库会只显示CAN信号的原始值。加载的数据库文件可保存到CanToolApp设定文件中，供下次使用。
###加载的CAN信息和信号数据库显示需求分析###
加载用户提供的CAN信息和信号数据库，以树状结构显示在GUI界面中，供参考。
###CAN信息和信号数据库格式需求分析###
将用户提供的CAN信息和信号数据库另存为xml和JSON (JavaScript Object Notation)格式。或者将xml或Json格式的数据库，转换为CAN信息和信号数据库格式。
###CAN信息和信号数据库更新到远程数据库需求分析###
可以将所有CAN信息实时数据、CAN设定信息等 通过WEB API方式更新到远程数据库。此时CanToolApp作为客户端与远程的Web API服务进行数据交换。此功能需要完成WebAPI服务器端的get\post等服务，实现数据的增删改查、可视化数据显示，实现数据共享



## 性能需求分析##
###精度需求###
- 用户在选择与上位机连接的串口号是，串口的波特率固定为115200BPS，8个数据位，1个停止位。
- 在CAN信息进行通信的过程中，能够按照规定的信息格式与方法进行解析、组合，从而能够达到在CanToolApp、CAN总线以及CanTool装置之间进行精准的数据传输。
- 此外，能够精确的在用户图形界面（GUI）显示CAN信息（曲线，仪表盘等）。

###时间需求###
利用数据库技术，优化对数据库的操作以及对CAN信息的发送与接收处理，对于用户操作应在5秒以内作出响应。
###灵活性###
使用模块化设计，当用户需求发生变化时只需更改相应模块，从而保证了其灵活性。
###故障处理###
需能够应对如下故障情况进行相应的处理，并且保证数据不丢失。：

- CAN总线网络的故障
- 数据库出错
- 并发事件冲突

###适应性###
本文描述的CanToolApp能够适应的不同运行环境，例如在windowsXP，windows7，windows8，windows10等常见的操作系统中都可运行。

## 运行需求##
###用户界面###
使用App界面。用户端以客户端形式展示。
###硬件环境###
服务器一台
正常工作且接入网络的计算机若干
###软件环境###

- 服务器：
   操作系统：Windows XP及以上的操作系统
   VS2012
   数据库：MySQL
- 用户端：
   操作系统：Windows XP及以上




